{# templates/groupeTesteurs/list.html.twig #}

{% extends 'base.html.twig' %}

{% block title %}Liste des Groupe Testeurs{% endblock %}

{% block body %}
    <h1>Liste des Groupe Testeurs</h1>

    {# Search form with input and button, add here if needed #}
    

    {# Table to display Groupe Testeurs details #}
    <table id="groupeTesteursTable" class="table">
        <!-- Table header -->
        <thead>
            <tr>
                <th>ID</th>
                <th>Label</th>
                <th>Description</th>
                <th>Actions</th>
            </tr>
        </thead>
        <!-- Table body will be populated using JavaScript -->
        <tbody id="groupeTesteursTableBody"></tbody>
    </table>

    {# Add link to add new Groupe Testeur #}
    <a href="{{ path('groupe_testeurs_add') }}">Ajouter</a>

    <script>
        // Function to initialize the table with values
        function initializeTable() {
            // Use DataTables to initialize the table
            $('#groupeTesteursTable').DataTable({
                // Your DataTables configuration options go here
            });

            // Fetch and update data for the initial table
            fetchDataAndUpdateTable();
        }

        // Function to perform search
        function performSearch() {
            // Trigger DataTables search
            $('#groupeTesteursTable').DataTable().search($('#search').val()).draw();
        }

        // Function to fetch and update data for the table
        function fetchDataAndUpdateTable() {
            // Use AJAX to fetch data for the initial table
            $.ajax({
                url: '{{ path('groupe_testeurs_list') }}',
                method: 'GET',
                success: function(response) {
                    // Update the DataTable with the fetched data
                    updateTable(response.groupeTesteurs);
                },
                error: function() {
                    // Handle errors
                    console.error('Initial data request failed');
                }
            });
        }

        // Function to update the table
        function updateTable(groupeTesteurs) {
            // Get the DataTable instance
            const dataTable = $('#groupeTesteursTable').DataTable();

            // Clear existing rows
            dataTable.clear();

            // Iterate over the data and add rows to the table
            groupeTesteurs.forEach(function (groupeTesteur) {
                dataTable.row.add([
                    groupeTesteur.id,
                    groupeTesteur.groupTesteurLabel,
                    groupeTesteur.groupTesteurDescription,
                    `<a href="/groupe_testeurs_delete/${groupeTesteur.id}">Supprimer</a>
                    <a href="/groupe_testeurs_edit/${groupeTesteur.id}">Modifier</a>`
                ]).draw();
            });
        }

        // Call initialization function when the page loads
        $(document).ready(initializeTable);
    </script>
{% endblock %}
